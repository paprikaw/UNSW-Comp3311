<html>
<head>
<title>RA Set Operations</title>
<link href='lib/slides.css' rel='stylesheet' type='text/css'>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML" async></script>
<script src='https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js'></script>
<link href='https://fonts.googleapis.com/css?family=Lato' rel='stylesheet'>
<link href='lib/prism.css' rel='stylesheet'>
<script src='lib/sg.js'></script>
</head>
<body>
 <DIV class='slideCl1' id="s0"  >
<div class='navCl1'><a href="#s1"><span class='nextArrowCl'>>></span></a> </div> <div class='heading'>RA Set Operations</div><p><ul class='indexUl'  style='font-size: 0.7em;'><li class="i"> <a href="#s1">RA Set Operations</a>
<li class="i"> <a href="#s2">Union</a>
<li class="i"> <a href="#s3">Intersection</a>
<li class="i"> <a href="#s6">Difference</a>
</ul></DIV>
<div class='slideNumCl2'>COMP3311 20T3 &#9826; RA Set Operations &#9826; [0/8]</div> <DIV class='slideCl1    ' id="s1"  >
<div class='navCl1'> <a href="#s0"><span class='upArrowCl'>&and;</span></a>  <a href="#s2"><span class='nextArrowCl'> >> </span></a> </div> <table width='100%' cellpadding='0'>
<tr valign='top'><td align='left'><div class='heading'>&#10070; RA Set Operations</div></td><td align='right'></td></tr></table>
<p>
<br>
Relational algebra defines three set operations
<ul>
<li> union  &nbsp; ... &nbsp; R &cup; S  &nbsp; ... &nbsp; (Query<sub>1</sub>) <large><code>UNION</code></large> (Query<sub>2</sub>)
<li> intersection  &nbsp; ... &nbsp; R &cap; S  &nbsp; ... &nbsp; (Query<sub>1</sub>) <large><code>INTERSECT</code></large> (Query<sub>2</sub>)
<li> difference  &nbsp; ... &nbsp; R - S  &nbsp; ... &nbsp; (Query<sub>1</sub>) <large><code>EXCEPT</code></large> (Query<sub>2</sub>)

</ul>
All relations involved must have the same schema &nbsp; <small>(union-compatible)</small>
<p>
All operations give a <i>set</i> of results &nbsp; <small>(i.e. no duplicates)</small>
<p>
To get <i>bag</i> semantics, use <large><code>UNION ALL</code></large>, etc.
</DIV>
<div class='slideNumCl2'>COMP3311 20T3 &#9826; RA Set Operations &#9826; [1/8]</div> <DIV class='slideCl1    ' id="s2"  >
<div class='navCl1'><a href="#s1"><span class='prevArrowCl'> << </span></a>  <a href="#s0"><span class='upArrowCl'>&and;</span></a>  <a href="#s3"><span class='nextArrowCl'> >> </span></a> </div> <table width='100%' cellpadding='0'>
<tr valign='top'><td align='left'><div class='heading'>&#10070; Union</div></td><td align='right'></td></tr></table>
<p>
<br>
<font color='#0000BB'>Union</font> combines two <font color='#0000BB'>compatible</font> relations into
a single relation via set union of sets of tuples.
<p>
<div class='center'>
<i>r<sub>1</sub> &cup; r<sub>2</sub></i> &nbsp; = &nbsp; { <i>t</i> &nbsp;|&nbsp; <i>t &isin; r<sub>1</sub> &or; t &isin; r<sub>2</sub></i> }, &nbsp;&nbsp;&nbsp; where <i>r<sub>1</sub>(R), r<sub>2</sub>(R)</i>
</div>
<p>
Result size: &nbsp; |<i>r<sub>1</sub> &cup; r<sub>2</sub></i>| &nbsp; <i>&le;</i> &nbsp;
|<i>r<sub>1</sub></i>| + |<i>r<sub>2</sub></i>|
&nbsp;&nbsp;&nbsp;
Result schema: <i>R</i>
<p>
Algorithmic view:
<p><pre>
<i>result</i> = <i>r<sub>1</sub></i>
for each tuple <i>t</i> in relation <i>r<sub>2</sub></i>
    <i>result</i> = <i>result &cup; {t}</i>
</pre><p>
</DIV>
<div class='slideNumCl2'>COMP3311 20T3 &#9826; RA Set Operations &#9826; [2/8]</div> <DIV class='slideCl1    ' id="s3"  >
<div class='navCl1'><a href="#s2"><span class='prevArrowCl'> << </span></a>  <a href="#s0"><span class='upArrowCl'>&and;</span></a>  <a href="#s4"><span class='nextArrowCl'> >> </span></a> </div> <table width='100%' cellpadding='0'>
<tr valign='top'><td align='left'><div class='heading'>&#10070; Intersection</div></td><td align='right'></td></tr></table>
<p>
<br>
<font color='#0000BB'>Intersection</font> combines two <font color='#0000BB'>compatible</font>
relations into a single relation via set intersection of sets of tuples.
<p>
<div class='center'>
<i>r<sub>1</sub> &cap; r<sub>2</sub></i> &nbsp; = &nbsp; { <i>t</i> &nbsp;|&nbsp; <i>t &isin; r<sub>1</sub> &and; t &isin; r<sub>2</sub></i> }, &nbsp;&nbsp;&nbsp; where <i>r<sub>1</sub>(R), r<sub>2</sub>(R)</i>
</div>
<p>
Result size: &nbsp; |<i>r<sub>1</sub> &cap; r<sub>2</sub></i>| &nbsp; <i>&le;</i> &nbsp;
min(|<i>r<sub>1</sub></i>|,|<i>r<sub>2</sub></i>|)
&nbsp;&nbsp;&nbsp;
Result schema: <i>R</i>
<p>
Algorithmic view:
<p><pre>
<i>result</i> = {}
for each tuple <i>t</i> in relation <i>r<sub>1</sub></i>
    if (<i>t &isin; r<sub>2</sub></i>) { <i>result</i> = <i>result &cup; {t}</i> }
</pre><p>
</DIV>
<div class='slideNumCl2'>COMP3311 20T3 &#9826; RA Set Operations &#9826; [3/8]</div> <DIV class='slideCl1    ' id="s4"  >
<div class='navCl1'><a href="#s3"><span class='prevArrowCl'> << </span></a>  <a href="#s0"><span class='upArrowCl'>&and;</span></a>  <a href="#s5"><span class='nextArrowCl'> >> </span></a> </div> <table width='100%' cellpadding='0'>
<tr valign='top'><td align='left'><div class='heading'>&#10070; Intersection <span style="font-size:67%">(cont)</span></div></td><td align='right'></td></tr></table>
<p>
Examples of union and intersection:
<p>
<p><div align='center'>
<img alt="[Diagram:Pics/relalg/setops.png]" src="Pics/relalg/setops.png">
</div><p>
</DIV>
<div class='slideNumCl2'>COMP3311 20T3 &#9826; RA Set Operations &#9826; [4/8]</div> <DIV class='slideCl1    ' id="s5"  >
<div class='navCl1'><a href="#s4"><span class='prevArrowCl'> << </span></a>  <a href="#s0"><span class='upArrowCl'>&and;</span></a>  <a href="#s6"><span class='nextArrowCl'> >> </span></a> </div> <table width='100%' cellpadding='0'>
<tr valign='top'><td align='left'><div class='heading'>&#10070; Intersection <span style="font-size:67%">(cont)</span></div></td><td align='right'></td></tr></table>
<p>
Querying with relational algebra (set operations)...
<ul>
<br>
<li> Bars where either John or Gernot drinks
<p><pre style="font-size:90%">
JohnBars = Proj[bar](Sel[drinker=John](Frequents))
GernotBars = Proj[bar](Sel[drinker=Gernot](Frequents))

Result = JohnBars union GernotBars
</pre><p>
<br>
<li> Bars where both John and Gernot drink
<p><pre style="font-size:90%">
Result = JohnBars  intersect  GernotBars
</pre><p>
</ul>
</DIV>
<div class='slideNumCl2'>COMP3311 20T3 &#9826; RA Set Operations &#9826; [5/8]</div> <DIV class='slideCl1    ' id="s6"  >
<div class='navCl1'><a href="#s5"><span class='prevArrowCl'> << </span></a>  <a href="#s0"><span class='upArrowCl'>&and;</span></a>  <a href="#s7"><span class='nextArrowCl'> >> </span></a> </div> <table width='100%' cellpadding='0'>
<tr valign='top'><td align='left'><div class='heading'>&#10070; Difference</div></td><td align='right'></td></tr></table>
<p>
<font color='#0000BB'>Difference</font> finds the set of tuples that exist in
one relation but do not occur in a second <font color='#0000BB'>compatible</font> relation.
<p>
<div class='center'>
<i>r<sub>1</sub> - r<sub>2</sub></i> &nbsp; = &nbsp; { <i>t</i> &nbsp;|&nbsp; <i>t &isin; r<sub>1</sub> &and; t &notin; r<sub>2</sub></i> }, &nbsp;&nbsp;&nbsp; where <i>r<sub>1</sub>(R), r<sub>2</sub>(R)</i>
</div>
<p>
Uses same notion of relation compatibility as union.
<p>
Note:
tuples in <i>r<sub>2</sub></i> but not <i>r<sub>1</sub></i> do not appear in the result
<ul>
<li> i.e. set difference != complement of set intersection
</ul>
Algorithmic view:
<p><pre>
<i>result</i> = {}
for each tuple <i>t</i> in relation <i>r<sub>1</sub></i>
    if (!(<i>t &isin; r<sub>2</sub></i>)) { <i>result</i> = <i>result &cup; {t}</i> }
</pre><p>
</DIV>
<div class='slideNumCl2'>COMP3311 20T3 &#9826; RA Set Operations &#9826; [6/8]</div> <DIV class='slideCl1    ' id="s7"  >
<div class='navCl1'><a href="#s6"><span class='prevArrowCl'> << </span></a>  <a href="#s0"><span class='upArrowCl'>&and;</span></a>  <a href="#s8"><span class='nextArrowCl'> >> </span></a> </div> <table width='100%' cellpadding='0'>
<tr valign='top'><td align='left'><div class='heading'>&#10070; Difference <span style="font-size:67%">(cont)</span></div></td><td align='right'></td></tr></table>
<p>
Examples of difference:
<p>
<p><div align='center'>
<img alt="[Diagram:Pics/relalg/difference2.png]" src="Pics/relalg/difference2.png">
</div><p>
&nbsp;<p>
Clearly, difference is not symmetric.
</DIV>
<div class='slideNumCl2'>COMP3311 20T3 &#9826; RA Set Operations &#9826; [7/8]</div> <DIV class='slideCl1    ' id="s8"  >
<div class='navCl1'><a href="#s7"><span class='prevArrowCl'> << </span></a>  <a href="#s0"><span class='upArrowCl'>&and;</span></a>   </div> <table width='100%' cellpadding='0'>
<tr valign='top'><td align='left'><div class='heading'>&#10070; Difference <span style="font-size:67%">(cont)</span></div></td><td align='right'></td></tr></table>
<p>
Querying with relational algebra (difference) ...
<ul>
<br>
<li> Bars where John drinks and Gernot doesn't
<p><pre style="font-size:90%">
JohnBars = Proj[bar](Sel[drinker=John](Frequents))
GernotBars = Proj[bar](Sel[drinker=Gernot](Frequents))

Result = JohnBars - GernotBars
</pre><p>
<li> Bars that sell VB but not New
<p><pre style="font-size:90%">
VBBars = Proj[bar](Sel[beer=VB](Sells))
NewBars = Proj[bar](Sel[beer=New](Sells))

Result = VBBars - NewBars
</pre><p>
</ul>
</DIV>
<div class='slideNumCl2'>COMP3311 20T3 &#9826; RA Set Operations &#9826; [8/8]</div><p><hr><p>
<span style='font-size:11px;color: grey;'>Produced: 11 Nov 2020</span>
 <script src='lib/prism.js'></script>   
 <script src='lib/sg.js'></script>   
</body>
</html>
