<html>
<head>
<title>Serializability</title>
<link href='lib/slides.css' rel='stylesheet' type='text/css'>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML" async></script>
<script src='https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js'></script>
<link href='https://fonts.googleapis.com/css?family=Lato' rel='stylesheet'>
<link href='lib/prism.css' rel='stylesheet'>
<script src='lib/sg.js'></script>
</head>
<body>
 <DIV class='slideCl1' id="s0"  >
<div class='navCl1'><a href="#s1"><span class='nextArrowCl'>>></span></a> </div> <div class='heading'>Serializability</div><p><ul class='indexUl'  style='font-size: 0.7em;'><li class="i"> <a href="#s1">Serializability</a>
<li class="i"> <a href="#s2">Conflict Serializability</a>
<li class="i"> <a href="#s6">Conflict Serializability Example</a>
<li class="i"> <a href="#s7">View Serializability</a>
<li class="i"> <a href="#s9">View Serializability Example</a>
</ul></DIV>
<div class='slideNumCl2'>COMP3311 20T3 &#9826; Serializability &#9826; [0/10]</div> <DIV class='slideCl1    ' id="s1"  >
<div class='navCl1'> <a href="#s0"><span class='upArrowCl'>&and;</span></a>  <a href="#s2"><span class='nextArrowCl'> >> </span></a> </div> <table width='100%' cellpadding='0'>
<tr valign='top'><td align='left'><div class='heading'>&#10070; Serializability</div></td><td align='right'></td></tr></table>
<p>
<br>
<font color='#0000BB'>Serializable</font> schedule:
<ul>
<li> concurrent schedule for <i>T<sub>1</sub> ..T<sub>n</sub></i> with final state <i>S</i>
<li> <i>S</i> &nbsp;is also a final state of a possible
	 serial schedule for <i>T<sub>1</sub> ..T<sub>n</sub></i>
</ul>
<p>
Abstracting this needs a notion of <font color='#0000BB'>schedule equivalence</font>.
<p>
Two common formulations of <font color='#0000BB'>serializability</font>:
<ul>
<li> <font color='#0000BB'>conflict serializibility</font>
	&nbsp; <small>(read/write operations occur in the "right" order)</small>

<li> <font color='#0000BB'>view serializibility</font>
	&nbsp; <small>(read operations <i>see</i> the correct version of data)</small>
</ul>
</DIV>
<div class='slideNumCl2'>COMP3311 20T3 &#9826; Serializability &#9826; [1/10]</div> <DIV class='slideCl1    ' id="s2"  >
<div class='navCl1'><a href="#s1"><span class='prevArrowCl'> << </span></a>  <a href="#s0"><span class='upArrowCl'>&and;</span></a>  <a href="#s3"><span class='nextArrowCl'> >> </span></a> </div> <table width='100%' cellpadding='0'>
<tr valign='top'><td align='left'><div class='heading'>&#10070; Conflict Serializability</div></td><td align='right'></td></tr></table>
<p>
Consider two transactions <i>T<sub>1</sub></i> and <i>T<sub>2</sub></i>
acting on data item <i>X</i>.
<p>
Possible orders for read/write operations by  <i>T<sub>1</sub></i> and <i>T<sub>2</sub></i>:
<p>
<div class='center'>
<table border='0' cellpadding='4'>
<tr valign=top>
<td><nobr><b><i>T<sub>1</sub></i> first</b></td>
<td></td><td> &nbsp; </td>
<td></td><td><b><i>T<sub>2</sub></i> first</b></td>
<td></td><td> &nbsp; </td>
<td></td><td>Equiv?</td>
</tr>
<tr valign=top>
<td><nobr><i>R<sub>1</sub>(X) R<sub>2</sub>(X)</i></td>
<td></td><td> &nbsp; </td>
<td></td><td><i>R<sub>2</sub>(X) R<sub>1</sub>(X)</i></td>
<td></td><td> &nbsp; </td>
<td></td><td>yes</td>
</tr>
<tr valign=top>
<td><nobr><i>R<sub>1</sub>(X) W<sub>2</sub>(X)</i></td>
<td></td><td> &nbsp; </td>
<td></td><td><i>W<sub>2</sub>(X) R<sub>1</sub>(X)</i></td>
<td></td><td> &nbsp; </td>
<td></td><td>no</td>
</tr>
<tr valign=top>
<td><nobr><i>W<sub>1</sub>(X) R<sub>2</sub>(X)</i></td>
<td></td><td> &nbsp; </td>
<td></td><td><i>R<sub>2</sub>(X) W<sub>1</sub>(X)</i></td>
<td></td><td> &nbsp; </td>
<td></td><td>no</td>
</tr>
<tr valign=top>
<td><nobr><i>W<sub>1</sub>(X) W<sub>2</sub>(X)</i></td>
<td></td><td> &nbsp; </td>
<td></td><td><i>W<sub>2</sub>(X) W<sub>1</sub>(X)</i></td>
<td></td><td> &nbsp; </td>
<td></td><td>no</td>
</tr>
</table>
</div>
<p>
<small>
If <i>T<sub>1</sub></i> and <i>T<sub>2</sub></i> act on different data items,
result is always equivalent.
</small>
</DIV>
<div class='slideNumCl2'>COMP3311 20T3 &#9826; Serializability &#9826; [2/10]</div> <DIV class='slideCl1    ' id="s3"  >
<div class='navCl1'><a href="#s2"><span class='prevArrowCl'> << </span></a>  <a href="#s0"><span class='upArrowCl'>&and;</span></a>  <a href="#s4"><span class='nextArrowCl'> >> </span></a> </div> <table width='100%' cellpadding='0'>
<tr valign='top'><td align='left'><div class='heading'>&#10070; Conflict Serializability <span style="font-size:67%">(cont)</span></div></td><td align='right'></td></tr></table>
<p>
Two transactions have a potential <font color='#0000BB'>conflict</font> if
<ul>
<li> they perform operations on the same data item
<li> at least one of the operations is a write operation
</ul>
In such cases, the order of operations affects the result.
<p>
If no conflict, can swap order without affecting the result.
<p>
If we can transform a schedule
<ul>
<li> by swapping the order of non-conflicting operations
<li> such that the result is a serial schedule
</ul>
then we say that the schedule is <font color='#0000BB'>conflict serializible</font>.
</DIV>
<div class='slideNumCl2'>COMP3311 20T3 &#9826; Serializability &#9826; [3/10]</div> <DIV class='slideCl1    ' id="s4"  >
<div class='navCl1'><a href="#s3"><span class='prevArrowCl'> << </span></a>  <a href="#s0"><span class='upArrowCl'>&and;</span></a>  <a href="#s5"><span class='nextArrowCl'> >> </span></a> </div> <table width='100%' cellpadding='0'>
<tr valign='top'><td align='left'><div class='heading'>&#10070; Conflict Serializability <span style="font-size:67%">(cont)</span></div></td><td align='right'></td></tr></table>
<p>
Example: transform a concurrent schedule to serial schedule
<p><pre>
T1: R(A) W(A)      R(B)      W(B)
T2:           R(A)      W(A)      R(B) W(B)
<font color="#CC0000">swap</font>
T1: R(A) W(A) <font color="#008800">R(B)</font>           W(B)
T2:                <font color="#008800">R(A)</font> W(A)      R(B) W(B)
<font color="#CC0000">swap</font>
T1: R(A) W(A) R(B)      <font color="#008800">W(B)</font>
T2:                R(A)      <font color="#008800">W(A)</font> R(B) W(B)
<font color="#CC0000">swap</font>
T1: R(A) W(A) R(B) <font color="#008800">W(B)</font>
T2:                     <font color="#008800">R(A)</font> W(A) R(B) W(B)
</pre><p>
</DIV>
<div class='slideNumCl2'>COMP3311 20T3 &#9826; Serializability &#9826; [4/10]</div> <DIV class='slideCl1    ' id="s5"  >
<div class='navCl1'><a href="#s4"><span class='prevArrowCl'> << </span></a>  <a href="#s0"><span class='upArrowCl'>&and;</span></a>  <a href="#s6"><span class='nextArrowCl'> >> </span></a> </div> <table width='100%' cellpadding='0'>
<tr valign='top'><td align='left'><div class='heading'>&#10070; Conflict Serializability <span style="font-size:67%">(cont)</span></div></td><td align='right'></td></tr></table>
<p>
Checking for conflict-serializability:
<ul>
<li> show that ordering in concurrent schedule
<li> cannot be achieved in any serial schedule
</ul>
Method for doing this:
<ul>
<li> build a <font color='#0000BB'>precedence-graph</font>
<li> nodes represent transactions
<li> arcs represent order of action on shared data
<li> arc from <i>T<sub>1</sub>&rarr;T<sub>2</sub></i>&nbsp; means
	<i>T<sub>1</sub></i>&nbsp; acts on <i>X</i>&nbsp; before <i>T<sub>2</sub></i>
<li> a cycle indicates <i>not</i>&nbsp; conflict-serializable.
</ul>
</DIV>
<div class='slideNumCl2'>COMP3311 20T3 &#9826; Serializability &#9826; [5/10]</div> <DIV class='slideCl1    ' id="s6"  >
<div class='navCl1'><a href="#s5"><span class='prevArrowCl'> << </span></a>  <a href="#s0"><span class='upArrowCl'>&and;</span></a>  <a href="#s7"><span class='nextArrowCl'> >> </span></a> </div> <table width='100%' cellpadding='0'>
<tr valign='top'><td align='left'><div class='heading'>&#10070; Conflict Serializability Example</div></td><td align='right'></td></tr></table>
<p>
Example schedule which is not conflict serializable:
<p><pre>
T1: R(X)           R(Y) W(X)      W(Y)
T2:           R(X)           W(X)
T3:      R(X)                          W(X)
<font color="#CC0000">attempted swaps</font>
T1:           R(X) W(X)          R(Y) W(Y)
T2:      R(X)           W(X)
T3: R(X)                     W(X)
</pre><p>
Precendence graph for the above schedule:
<p><div align='center'>
<img alt="[Diagram:Pics/xact/prec-graph.png]" src="Pics/xact/prec-graph.png">
</div><p>
</DIV>
<div class='slideNumCl2'>COMP3311 20T3 &#9826; Serializability &#9826; [6/10]</div> <DIV class='slideCl1    ' id="s7"  >
<div class='navCl1'><a href="#s6"><span class='prevArrowCl'> << </span></a>  <a href="#s0"><span class='upArrowCl'>&and;</span></a>  <a href="#s8"><span class='nextArrowCl'> >> </span></a> </div> <table width='100%' cellpadding='0'>
<tr valign='top'><td align='left'><div class='heading'>&#10070; View Serializability</div></td><td align='right'></td></tr></table>
<p>
<font color='#0000BB'>View Serializability</font> is
<ul>
<li> an alternative formulation of serializability
<li> that is less conservative than conflict serializability (CS) <br>
	<small>(some safe schedules that are view serializable are not conflict serializable)</small>
</ul>
As with CS, it is based on a notion of schedule equivalence
<ul>
<li> a schedule is "safe" if <i>view equivalent</i> to a serial schedule
</ul>
The idea: if, across the two schedules ...
<ul>
<li> they read the same version of a shared object
<li> they write the same final version of an object
</ul>
then they are <font color='#0000BB'>view equivalent</font>
</DIV>
<div class='slideNumCl2'>COMP3311 20T3 &#9826; Serializability &#9826; [7/10]</div> <DIV class='slideCl1    ' id="s8"  >
<div class='navCl1'><a href="#s7"><span class='prevArrowCl'> << </span></a>  <a href="#s0"><span class='upArrowCl'>&and;</span></a>  <a href="#s9"><span class='nextArrowCl'> >> </span></a> </div> <table width='100%' cellpadding='0'>
<tr valign='top'><td align='left'><div class='heading'>&#10070; View Serializability <span style="font-size:67%">(cont)</span></div></td><td align='right'></td></tr></table>
<p>
Two schedules <i>S</i> and <i>S'</i> on <i>T<sub>1</sub> .. T<sub>n</sub></i>
are <font color='#0000BB'>view equivalent</font> iff
<ul>
<li> for each shared data item <i>X</i>
<ul>
<li> if, in <i>S</i>, <i>T<sub>j</sub></i> reads the initial value of <i>X</i>, <br>
	then, in <i>S'</i>, <i>T<sub>j</sub></i> also reads the initial value of <i>X</i>
<li> if, in <i>S</i>, <i>T<sub>j</sub></i> reads <i>X</i> written by <i>T<sub>k</sub></i>,<br>
then, in <i>S'</i> <i>T<sub>j</sub></i> also reads the value of <i>X</i> written by <i>T<sub>k</sub></i> in <i>S'</i>
<li> if, in <i>S</i>, <i>T<sub>j</sub></i> performs the final write of <i>X</i>,<br>
then, in <i>S'</i>, <i>T<sub>j</sub></i>  also performs the final write of <i>X</i>
</ul>
</ul>
To check serializibilty of <i>S</i> ...
<ul>
<li> find a serial schedule that is <i>view equivalent</i> to <i>S</i>
<li> from among the <i>n!</i> possible serial schedules
</ul>
</DIV>
<div class='slideNumCl2'>COMP3311 20T3 &#9826; Serializability &#9826; [8/10]</div> <DIV class='slideCl1    ' id="s9"  >
<div class='navCl1'><a href="#s8"><span class='prevArrowCl'> << </span></a>  <a href="#s0"><span class='upArrowCl'>&and;</span></a>  <a href="#s10"><span class='nextArrowCl'> >> </span></a> </div> <table width='100%' cellpadding='0'>
<tr valign='top'><td align='left'><div class='heading'>&#10070; View Serializability Example</div></td><td align='right'></td></tr></table>
<p>
Example: consider the following concurrent schedule
<p><pre>
T1: R(A) W(A)      R(B)      W(B)
T2:           R(A)      W(A)      R(B) W(B)
</pre><p>
If view serializable, the read/write behaviour must be like one of
<ol>
<li>
<p><pre>
T1: R(A) W(A) R(B) W(B)
T2:                     R(A) W(A) R(B) W(B)
</pre><p>
<li>
<p><pre>
T1:                     R(A) W(A) R(B) W(B)
T2: R(A) W(A) R(B) W(B)
</pre><p>
</ol>
</DIV>
<div class='slideNumCl2'>COMP3311 20T3 &#9826; Serializability &#9826; [9/10]</div> <DIV class='slideCl1    ' id="s10"  >
<div class='navCl1'><a href="#s9"><span class='prevArrowCl'> << </span></a>  <a href="#s0"><span class='upArrowCl'>&and;</span></a>   </div> <table width='100%' cellpadding='0'>
<tr valign='top'><td align='left'><div class='heading'>&#10070; View Serializability Example <span style="font-size:67%">(cont)</span></div></td><td align='right'></td></tr></table>
<p>
Reminder of concurrent schedule
<p><pre>
T1: R(A) W(A)      R(B)      W(B)
T2:           R(A)      W(A)      R(B) W(B)
</pre><p>
In the concurrent schedule
<ul>
<li> A: T1 reads initial, T2 reads T1's write, T2 writes final
<li> B: T1 reads initial, T2 reads T1's write, T2 writes final
</ul>
In T1;T2
<ul>
<li> A: T1 reads initial, T2 reads T1's write, T2 writes final
<li> B: T1 reads initial, T2 reads T1's write, T2 writes final
</ul>
So, concurrent schedule is view equivalent to T1;T2
</DIV>
<div class='slideNumCl2'>COMP3311 20T3 &#9826; Serializability &#9826; [10/10]</div><p><hr><p>
<span style='font-size:11px;color: grey;'>Produced: 15 Nov 2020</span>
 <script src='lib/prism.js'></script>   
 <script src='lib/sg.js'></script>   
</body>
</html>
